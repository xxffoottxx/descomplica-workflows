<!DOCTYPE html>
<html lang="pt-PT">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#2563eb">
  <meta name="description" content="Dashboard de Neg√≥cios - Acompanhe as suas m√©tricas em tempo real">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Dashboard">

  <title>Dashboard de Neg√≥cios</title>

  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="assets/icon-192.png">
  <link rel="apple-touch-icon" href="assets/icon-192.png">

  <!-- Styles -->
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>

  <!-- PIN Protection Screen -->
  <div id="pin-screen" class="pin-screen">
    <div class="pin-container">
      <div class="pin-header">
        <div class="pin-logo">
          <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect width="48" height="48" rx="12" fill="#2563eb"/>
            <path d="M24 12L34 20V36H28V28H20V36H14V20L24 12Z" fill="white"/>
          </svg>
        </div>
        <h1 class="pin-title">Dashboard de Neg√≥cios</h1>
        <p class="pin-subtitle">Introduza o seu PIN</p>
      </div>

      <form id="pin-form" class="pin-form">
        <div id="pin-display" class="pin-display"></div>
        <div id="pin-error" class="pin-error"></div>

        <div class="keypad">
          <button type="button" class="keypad-btn" data-digit="1">1</button>
          <button type="button" class="keypad-btn" data-digit="2">2</button>
          <button type="button" class="keypad-btn" data-digit="3">3</button>
          <button type="button" class="keypad-btn" data-digit="4">4</button>
          <button type="button" class="keypad-btn" data-digit="5">5</button>
          <button type="button" class="keypad-btn" data-digit="6">6</button>
          <button type="button" class="keypad-btn" data-digit="7">7</button>
          <button type="button" class="keypad-btn" data-digit="8">8</button>
          <button type="button" class="keypad-btn" data-digit="9">9</button>
          <button type="button" class="keypad-btn keypad-clear" data-action="clear">‚å´</button>
          <button type="button" class="keypad-btn" data-digit="0">0</button>
          <button type="button" class="keypad-btn keypad-delete" data-action="delete">‚Üê</button>
        </div>
      </form>

      <div class="pin-footer">
        <p class="pin-hint">PIN padr√£o: 1234</p>
      </div>
    </div>
  </div>

  <!-- Main Dashboard -->
  <div id="main-app" class="main-app" style="display: none; opacity: 0;">

    <!-- Header -->
    <header class="app-header">
      <div class="header-content">
        <div class="header-title">
          <h1>Dashboard</h1>
          <p class="header-date" id="current-date"></p>
        </div>
        <div class="header-actions">
          <button id="refresh-btn" class="btn-icon" title="Atualizar dados">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="last-update">
        √öltima atualiza√ß√£o: <span id="last-update-time">--:--</span>
      </div>
    </header>

    <!-- Main Content -->
    <main class="app-content">

      <!-- Quick Actions -->
      <section class="quick-actions">
        <button id="generate-report-btn" class="btn-primary">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
            <line x1="16" y1="13" x2="8" y2="13"/>
            <line x1="16" y1="17" x2="8" y2="17"/>
            <polyline points="10 9 9 9 8 9"/>
          </svg>
          Gerar Relat√≥rio
        </button>
      </section>

      <!-- Resumo do Dia -->
      <section class="dashboard-section">
        <h2 class="section-title">Resumo do Dia</h2>
        <div class="metrics-grid">

          <div class="metric-card metric-revenue">
            <div class="metric-icon">‚Ç¨</div>
            <div class="metric-content">
              <div class="metric-label">Receita Hoje</div>
              <div class="metric-value" id="revenue-today">‚Ç¨0,00</div>
              <div class="metric-change positive" id="revenue-change">+0%</div>
            </div>
          </div>

          <div class="metric-card metric-orders">
            <div class="metric-icon">üì¶</div>
            <div class="metric-content">
              <div class="metric-label">Pedidos</div>
              <div class="metric-value" id="orders-today">0</div>
              <div class="metric-change" id="orders-change">0%</div>
            </div>
          </div>

          <div class="metric-card metric-tasks">
            <div class="metric-icon">‚úì</div>
            <div class="metric-content">
              <div class="metric-label">Tarefas Abertas</div>
              <div class="metric-value" id="tasks-open">0</div>
              <div class="metric-change" id="tasks-completed">0 conclu√≠das</div>
            </div>
          </div>

          <div class="metric-card metric-emails">
            <div class="metric-icon">‚úâ</div>
            <div class="metric-content">
              <div class="metric-label">Emails</div>
              <div class="metric-value" id="emails-unread">0</div>
              <div class="metric-change" id="emails-important">0 importantes</div>
            </div>
          </div>

        </div>
      </section>

      <!-- Vendas -->
      <section class="dashboard-section">
        <h2 class="section-title">Vendas</h2>
        <div class="chart-tabs">
          <button class="tab-btn active" data-period="today">Hoje</button>
          <button class="tab-btn" data-period="week">Semana</button>
          <button class="tab-btn" data-period="month">M√™s</button>
        </div>
        <div class="chart-container">
          <canvas id="sales-chart"></canvas>
        </div>
        <div class="stats-row">
          <div class="stat-item">
            <span class="stat-label">Ticket M√©dio</span>
            <span class="stat-value" id="avg-ticket">‚Ç¨0,00</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Total Semana</span>
            <span class="stat-value" id="week-total">‚Ç¨0,00</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Total M√™s</span>
            <span class="stat-value" id="month-total">‚Ç¨0,00</span>
          </div>
        </div>
      </section>

      <!-- Tarefas -->
      <section class="dashboard-section">
        <h2 class="section-title">Tarefas</h2>
        <div class="tasks-summary">
          <div class="task-stat">
            <span class="task-count" id="tasks-open-count">0</span>
            <span class="task-label">Abertas</span>
          </div>
          <div class="task-stat">
            <span class="task-count" id="tasks-completed-count">0</span>
            <span class="task-label">Conclu√≠das Hoje</span>
          </div>
          <div class="task-stat">
            <span class="task-count alert" id="tasks-overdue-count">0</span>
            <span class="task-label">Atrasadas</span>
          </div>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="tasks-progress" style="width: 0%"></div>
        </div>
        <div class="progress-label">
          <span id="tasks-progress-text">0% conclu√≠do</span>
        </div>
      </section>

      <!-- Stock -->
      <section class="dashboard-section">
        <h2 class="section-title">Stock</h2>
        <div class="stock-grid">
          <div class="stock-card">
            <div class="stock-label">Stock Baixo</div>
            <div class="stock-value alert" id="low-stock-count">0</div>
            <div class="stock-sublabel">produtos</div>
          </div>
          <div class="stock-card">
            <div class="stock-label">Total Produtos</div>
            <div class="stock-value" id="total-products">0</div>
            <div class="stock-sublabel">itens</div>
          </div>
          <div class="stock-card">
            <div class="stock-label">Valor Stock</div>
            <div class="stock-value" id="stock-value">‚Ç¨0</div>
            <div class="stock-sublabel">estimado</div>
          </div>
        </div>
        <div id="low-stock-list" class="alert-list"></div>
      </section>

      <!-- Email -->
      <section class="dashboard-section">
        <h2 class="section-title">Email</h2>
        <div class="email-stats">
          <div class="email-stat">
            <div class="email-icon">üì®</div>
            <div class="email-info">
              <div class="email-count" id="email-unread-count">0</div>
              <div class="email-label">N√£o Lidas</div>
            </div>
          </div>
          <div class="email-stat">
            <div class="email-icon">‚≠ê</div>
            <div class="email-info">
              <div class="email-count" id="email-important-count">0</div>
              <div class="email-label">Importantes</div>
            </div>
          </div>
          <div class="email-stat">
            <div class="email-icon">‚Üó</div>
            <div class="email-info">
              <div class="email-count" id="email-sent-count">0</div>
              <div class="email-label">Enviadas Hoje</div>
            </div>
          </div>
        </div>
        <div class="email-response-rate">
          Taxa de Resposta: <span id="email-response-rate">0%</span>
        </div>
      </section>

      <!-- Equipa -->
      <section class="dashboard-section">
        <h2 class="section-title">Equipa</h2>
        <div class="team-summary">
          <div class="team-stat">
            <span class="team-count" id="team-present">0</span>
            <span class="team-label">Presentes</span>
          </div>
          <div class="team-stat">
            <span class="team-count" id="team-hours">0h</span>
            <span class="team-label">Horas Trabalhadas</span>
          </div>
        </div>
        <div id="team-list" class="team-list"></div>
      </section>

    </main>

    <!-- Footer -->
    <footer class="app-footer">
      <p>&copy; 2026 Dashboard de Neg√≥cios</p>
      <button id="logout-btn" class="btn-text">Sair</button>
    </footer>

  </div>

  <!-- Loading Overlay -->
  <div id="loading-overlay" class="loading-overlay" style="display: none;">
    <div class="spinner"></div>
    <p>A atualizar dados...</p>
  </div>

  <!-- Report Modal -->
  <div id="report-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Gerar Relat√≥rio</h2>
        <button id="close-modal" class="btn-icon-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="report-start-date">Data In√≠cio</label>
          <input type="date" id="report-start-date" class="form-input">
        </div>
        <div class="form-group">
          <label for="report-end-date">Data Fim</label>
          <input type="date" id="report-end-date" class="form-input">
        </div>
        <div class="form-actions">
          <button id="cancel-report-btn" class="btn-secondary">Cancelar</button>
          <button id="confirm-report-btn" class="btn-primary">Gerar PDF</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/auth.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="js/app.js"></script>

  <!-- Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js')
          .then(reg => console.log('Service Worker registado:', reg.scope))
          .catch(err => console.log('Erro ao registar Service Worker:', err));
      });
    }
  </script>

</body>
</html>
